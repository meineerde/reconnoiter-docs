<?xml version="1.0"?>
<section>
  <title>resmon_part</title>
  <para>The resmon_part module performs services checks against a specific Resmon module/service check.</para>
  <para><ulink url="https://labs.omniti.com/trac/resmon"><citetitle>Resmon</citetitle></ulink> is a light-weight resource monitor that exposes health of services over HTTP in XML.</para>
  <para>This module rides on the http module and provides a secondary phase of XML parsing on the contents that extracts a specific module and service from the Resmon XML report.</para>
  <variablelist>
    <varlistentry>
      <term>loader</term>
      <listitem>
        <para>C</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>image</term>
      <listitem>
        <para>http.so</para>
      </listitem>
    </varlistentry>
  </variablelist>
  <section>
    <title>Module Configuration</title>
    <variablelist>
      <varlistentry>
        <term>url</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>http://target:81/</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The default URL to be used by checks that do not specify an explicit URL.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>ca_chain</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>A path to a file containing all the certificate authorities that should be loaded to validate the remote certificate (for SSL checks).  This is used for SSL checks if this paramter is not set explicitly in the check config.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>certificate_file</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>A path to a file containing all the client certificate that will be presented to the remote server (for SSL checks).  This is used for SSL checks if this paramter is not set explicitly in the check config.</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </section>
  <section>
    <title>Check Configuration</title>
    <variablelist>
      <varlistentry>
        <term>url</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>required</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The URL including schema and hostname (as you would type into a browser's location bar).</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>ca_chain</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>A path to a file containing all the certificate authorities that should be loaded to validate the remote certificate (for SSL checks).</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>certificate_file</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>A path to a file containing all the client certificate that will be presented to the remote server (for SSL checks).</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>resmon_module</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>required</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The resmon module to check.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>resmon_service</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>required</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The resmon service to check.</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </section>
  <example>
    <title>Checking for two specific resmon services on OmniTI Labs.</title>
    <para>This example checks for hardware faults and the utilization of the root filesystem via the Resmon service on OmniTI Labs.</para>
    <programlisting>
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="http" name="resmon_part" /&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;labs target="8.8.38.5" module="resmon_part"&gt;
            &lt;check uuid="413a488c-796b-11dd-b98a-53f0f4b89ac3"&gt;
              &lt;config&gt;
                &lt;resmon_module&gt;FAULTS&lt;/resmon_module&gt;
                &lt;resmon_service&gt;hardware&lt;/resmon_service&gt;
              &lt;/config&gt;
            &lt;/check&gt;
            &lt;check uuid="4c33303c-796b-11dd-bfa1-6f55841e1fca"&gt;
              &lt;config&gt;
                &lt;resmon_module&gt;DISK&lt;/resmon_module&gt;
                &lt;resmon_service&gt;/&lt;/resmon_service&gt;
              &lt;/config&gt;
            &lt;/check&gt;
          &lt;/labs&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </programlisting>
  </example>
</section>
