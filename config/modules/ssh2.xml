<?xml version="1.0"?>
<section>
  <title>ssh2</title>
  <para>The ssh2 module allows reconnoiter to connect to servers over ssh protocol 2 and test the fingerprint.</para>
  <variablelist>
    <varlistentry>
      <term>loader</term>
      <listitem>
        <para>C</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>image</term>
      <listitem>
        <para>ssh2.so</para>
      </listitem>
    </varlistentry>
  </variablelist>
  <section>
    <title>Module Configuration</title>
  </section>
  <section>
    <title>Check Configuration</title>
    <variablelist>
      <varlistentry>
        <term>port</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para>22</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>\d+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The TCP port on which the remote server's ssh service is running.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>method_kex</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para/>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>^diffie-hellman-(?:group1-sha1|group14-sha1|group-exchange-sha1)$</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The key exchange method to use.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>method_hostkey</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para/>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>^(?:ssh-dss|ssh-rsa)$</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The host key algorithm supported.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>method_crypt_cs</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para/>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>^(?:aes256-ctr|aes192-ctr|aes128-ctr|aes256-cbc|aes192-cbc|aes128-cbc|blowfish-cbc|arcfour128|arcfour|cast128-cbc|3des-cbc|none)$</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The encryption algorithm used from client to server.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>method_crypt_sc</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para/>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>^(?:aes256-ctr|aes192-ctr|aes128-ctr|aes256-cbc|aes192-cbc|aes128-cbc|blowfish-cbc|arcfour128|arcfour|cast128-cbc|3des-cbc|none)$</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The encryption algorithm used from server to client.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>method_mac_cs</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para/>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>^(?:hmac-sha1|hmac-sha1-96|hmac-md5|hmac-md5-96|hmac-ripemd160|none)$</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The message authentication code algorithm used from client to server.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>method_mac_sc</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para/>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>^(?:hmac-sha1|hmac-sha1-96|hmac-md5|hmac-md5-96|hmac-ripemd160|none)$</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The message authentication code algorithm used from server to client.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>method_comp_cs</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para>none</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>^(?:zlib|none)$</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The compress algorithm used from client to server.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>method_comp_sc</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para>none</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>^(?:zlib|none)$</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The compress algorithm used from server to client.</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </section>
  <example>
    <title>Simple ssh polling of 4 machines</title>
    <para>The following checks ssh on 10.1.2.{3,4,5,6}</para>
    <programlisting>
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="ssh2" name="ssh2"/&gt;
        &lt;/modules&gt;
        &lt;checks&gt;
          &lt;ssh module="ssh2"&gt;
            &lt;check uuid="1cddb2a8-76ff-11dd-83c8-f75cb8b93bd9" target="10.1.2.3"/&gt;
            &lt;check uuid="1dd79110-76ff-11dd-9b54-739adc274a93" target="10.1.2.4"/&gt;
            &lt;check uuid="4627560a-76ff-11dd-941f-4b75679cb908" target="10.1.2.5"/&gt;
            &lt;check uuid="4fdcb8de-76ff-11dd-ae16-2740afc178ae" target="10.1.2.6"/&gt;
          &lt;/ssh&gt;
        &lt;/checks&gt;
      &lt;/noit&gt;
    </programlisting>
  </example>
</section>
